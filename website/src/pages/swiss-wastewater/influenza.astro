---
import { getLastUpdatedDate } from '../../lapis/getLastUpdatedDate';
import BaseLayout from '../../layouts/base/BaseLayout.astro';
import DataInfo from '../../layouts/base/footer/DataInfo.astro';
import { dataOrigins } from '../../types/dataOrigins';

const lapisUrl = 'https://api.wise-loculus.genspectrum.org/influenza';
const lastUpdatedDate = await getLastUpdatedDate(lapisUrl);
---

<BaseLayout title='Swiss wastewater - influenza'>
    <div class='m-6'>
        <h1 class='text-2xl'>Swiss wastewater - influenza</h1>
        <gs-app lapis={lapisUrl}>
            <div class='mt-4 w-full'>
                <gs-wastewater-mutations-over-time
                    height='400px'
                    lapisFilter={JSON.stringify({ versionStatus: 'LATEST_VERSION', isRevocation: false })}
                    sequenceType='nucleotide'></gs-wastewater-mutations-over-time>
            </div>
        </gs-app>

        <div class='flex justify-center' slot='secondary-footer'>
            <span class='mr-4 p-2 text-xs'>Data last updated: {lastUpdatedDate ?? 'unknown'}</span>
            <DataInfo dataOrigins={[dataOrigins.wise]} />
        </div>
    </div>
</BaseLayout>
